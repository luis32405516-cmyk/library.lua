-- [[ LUIS UNV - ELITE LIBRARY FIXED SYSTEM ]]

local Library = {}

if game:GetService("CoreGui"):FindFirstChild("Luis_Elite_SafeClose") then
    game:GetService("CoreGui"):FindFirstChild("Luis_Elite_SafeClose"):Destroy()
end

function Library:CreateWindow()
    local ScreenGui = Instance.new("ScreenGui")
    local Main = Instance.new("Frame")
    local Sidebar = Instance.new("ScrollingFrame")
    local Container = Instance.new("ScrollingFrame")

    ScreenGui.Parent = game:GetService("CoreGui")
    ScreenGui.Name = "Luis_Elite_SafeClose"

    Main.Name = "Main"; Main.Parent = ScreenGui; Main.BackgroundColor3 = Color3.fromRGB(10, 10, 10)
    Main.Position = UDim2.new(0.5, -170, 0.5, -110); Main.Size = UDim2.new(0, 360, 0, 230)
    Main.Active = true; Main.Draggable = true; Main.ClipsDescendants = true
    Instance.new("UICorner", Main).CornerRadius = UDim.new(0, 15)
    local MainStroke = Instance.new("UIStroke", Main); MainStroke.Thickness = 3

    -- [[ SIDEBAR ]]
    Sidebar.Name = "Sidebar"; Sidebar.Parent = Main; Sidebar.BackgroundColor3 = Color3.fromRGB(15, 15, 15)
    Sidebar.Position = UDim2.new(0, 8, 0, 42); Sidebar.Size = UDim2.new(0, 100, 1, -50)
    Sidebar.ScrollBarThickness = 3; Sidebar.ScrollBarImageColor3 = Color3.new(1, 1, 1)
    Sidebar.AutomaticCanvasSize = Enum.AutomaticSize.Y
    Instance.new("UICorner", Sidebar).CornerRadius = UDim.new(0, 10)
    local SidebarList = Instance.new("UIListLayout", Sidebar)
    SidebarList.Padding = UDim.new(0, 4); SidebarList.HorizontalAlignment = Enum.HorizontalAlignment.Center

    -- [[ CONTAINER ]]
    Container.Name = "Container"; Container.Parent = Main; Container.BackgroundColor3 = Color3.fromRGB(18, 18, 18)
    Container.Position = UDim2.new(0, 115, 0, 42); Container.Size = UDim2.new(1, -123, 1, -50)
    Container.ScrollBarThickness = 3; Container.ScrollBarImageColor3 = Color3.new(1, 1, 1)
    Container.AutomaticCanvasSize = Enum.AutomaticSize.Y
    Instance.new("UICorner", Container).CornerRadius = UDim.new(0, 10)
    local ContainerList = Instance.new("UIListLayout", Container)
    ContainerList.Padding = UDim.new(0, 8); ContainerList.HorizontalAlignment = Enum.HorizontalAlignment.Center

    -- Ciclo Neón
    task.spawn(function()
        while task.wait(0.01) do
            if not ScreenGui.Parent then break end
            MainStroke.Color = Color3.fromHSV(tick() % 5 / 5, 0.8, 1)
        end
    end)

    local Tabs = {}
    local FirstTab = true

    function Tabs:CreateTab(name)
        local TabContent = Instance.new("Frame")
        TabContent.Name = name .. "_Content"
        TabContent.Parent = Container
        TabContent.Size = UDim2.new(1, 0, 0, 0)
        TabContent.BackgroundTransparency = 1
        TabContent.Visible = false
        local TabContentList = Instance.new("UIListLayout", TabContent)
        TabContentList.Padding = UDim.new(0, 8); TabContentList.HorizontalAlignment = Enum.HorizontalAlignment.Center
        
        -- Ajuste de tamaño automático del contenido de la pestaña
        TabContentList:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
            TabContent.Size = UDim2.new(1, 0, 0, TabContentList.AbsoluteContentSize.Y + 10)
        end)

        local TabButton = Instance.new("TextButton", Sidebar)
        TabButton.Size = UDim2.new(0.9, 0, 0, 24); TabButton.BackgroundColor3 = Color3.fromRGB(30, 30, 30); TabButton.Text = name
        TabButton.TextColor3 = Color3.new(1, 1, 1); TabButton.Font = Enum.Font.GothamBold; TabButton.TextSize = 9
        Instance.new("UICorner", TabButton).CornerRadius = UDim.new(0, 6)

        -- Mostrar solo la primera pestaña al ejecutar
        if FirstTab then
            TabContent.Visible = true
            TabButton.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
            FirstTab = false
        end

        TabButton.MouseButton1Click:Connect(function()
            for _, v in pairs(Container:GetChildren()) do
                if v:IsA("Frame") then v.Visible = false end
            end
            for _, v in pairs(Sidebar:GetChildren()) do
                if v:IsA("TextButton") then v.BackgroundColor3 = Color3.fromRGB(30, 30, 30) end
            end
            TabContent.Visible = true
            TabButton.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
        end)

        local Elements = {}

        function Elements:CreateSwitch(text, callback)
            local Frame = Instance.new("Frame", TabContent)
            Frame.Size = UDim2.new(0.95, 0, 0, 32); Frame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
            Instance.new("UICorner", Frame).CornerRadius = UDim.new(0, 8)
            local Label = Instance.new("TextLabel", Frame)
            Label.Text = text; Label.Size = UDim2.new(0.6,0,1,0); Label.Position = UDim2.new(0,10,0,0); Label.BackgroundTransparency = 1; Label.TextColor3 = Color3.new(1,1,1); Label.Font = Enum.Font.GothamBold; Label.TextSize = 10; Label.TextXAlignment = Enum.TextXAlignment.Left
            local Toggle = Instance.new("TextButton", Frame)
            Toggle.Size = UDim2.new(0,38,0,20); Toggle.Position = UDim2.new(1,-45,0.5,-10); Toggle.BackgroundColor3 = Color3.fromRGB(45,45,45); Toggle.Text = ""
            Instance.new("UICorner", Toggle).CornerRadius = UDim.new(1,0)
            local Circle = Instance.new("Frame", Toggle)
            Circle.Size = UDim2.new(0,16,0,16); Circle.Position = UDim2.new(0,2,0.5,-8); Circle.BackgroundColor3 = Color3.new(1,1,1); Instance.new("UICorner", Circle).CornerRadius = UDim.new(1,0)
            local state = false
            Toggle.MouseButton1Click:Connect(function()
                state = not state
                Circle:TweenPosition(state and UDim2.new(1,-18,0.5,-8) or UDim2.new(0,2,0.5,-8), "Out", "Quart", 0.2, true)
                Toggle.BackgroundColor3 = state and Color3.fromRGB(0, 180, 100) or Color3.fromRGB(45, 45, 45)
                pcall(callback, state)
            end)
        end

        function Elements:CreateSlider(text, callback)
            local Frame = Instance.new("Frame", TabContent)
            Frame.Size = UDim2.new(0.95, 0, 0, 45); Frame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
            Instance.new("UICorner", Frame).CornerRadius = UDim.new(0, 8)
            local Label = Instance.new("TextLabel", Frame)
            Label.Text = text .. " : 0"; Label.Size = UDim2.new(1,-20,0,20); Label.Position = UDim2.new(0,10,0,5); Label.BackgroundTransparency = 1; Label.TextColor3 = Color3.new(1,1,1); Label.Font = Enum.Font.GothamBold; Label.TextSize = 10; Label.TextXAlignment = Enum.TextXAlignment.Left
            local SliderBG = Instance.new("TextButton", Frame)
            SliderBG.Size = UDim2.new(0.85,0,0,6); SliderBG.Position = UDim2.new(0.5,0,0,32); SliderBG.AnchorPoint = Vector2.new(0.5,0.5); SliderBG.BackgroundColor3 = Color3.fromRGB(40,40,40); SliderBG.Text = ""
            Instance.new("UICorner", SliderBG)
            local Fill = Instance.new("Frame", SliderBG)
            Fill.Size = UDim2.new(0,0,1,0); Fill.BackgroundColor3 = Color3.fromRGB(0, 150, 255); Instance.new("UICorner", Fill)
            local Knob = Instance.new("Frame", Fill)
            Knob.Size = UDim2.new(0,14,0,14); Knob.AnchorPoint = Vector2.new(0.5,0.5); Knob.Position = UDim2.new(1,0,0.5,0); Knob.BackgroundColor3 = Color3.new(1,1,1); Instance.new("UICorner", Knob).CornerRadius = UDim.new(1,0)
            local function move(input)
                local pos = math.clamp((input.Position.X - SliderBG.AbsolutePosition.X) / SliderBG.AbsoluteSize.X, 0, 1)
                Fill.Size = UDim2.new(pos, 0, 1, 0)
                local val = math.floor(0 + (300 - 0) * pos)
                Label.Text = text .. " : " .. val; pcall(callback, val)
            end
            local dragging = false
            SliderBG.InputBegan:Connect(function(i) if i.UserInputType == Enum.UserInputType.MouseButton1 then dragging = true end end)
            game:GetService("UserInputService").InputEnded:Connect(function(i) if i.UserInputType == Enum.UserInputType.MouseButton1 then dragging = false end end)
            game:GetService("UserInputService").InputChanged:Connect(function(i) if dragging and i.UserInputType == Enum.UserInputType.MouseMovement then move(i) end end)
        end

        return Elements
    end

    return Tabs
end

return Library
