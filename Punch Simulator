local RainbowUI = loadstring(game:HttpGet("https://raw.githubusercontent.com/luis32405516-cmyk/library.lua/refs/heads/main/Prueba2?v=" .. tick()))()
local hud = RainbowUI:CreateWindow(240, 450)

local player = game.Players.LocalPlayer
local RunService = game:GetService("RunService")
local state = { fly = false, flySpeed = 50, noclip = false }

local fMov = hud:AddFolder("AJUSTES PERSONAJE ⚙️")

-- LÓGICA DE VUELO REAL
fMov:AddButton("VOLAR (FLY)", function()
    state.fly = not state.fly
    local char = player.Character
    if not char or not char:FindFirstChild("HumanoidRootPart") then return end
    local root = char.HumanoidRootPart
    
    if state.fly then
        local bv = Instance.new("BodyVelocity", root)
        local bg = Instance.new("BodyGyro", root)
        bv.Name = "FlyVel"
        bg.Name = "FlyGyro"
        
        bv.MaxForce = Vector3.new(9e9, 9e9, 9e9)
        bg.MaxTorque = Vector3.new(9e9, 9e9, 9e9)
        bg.P = 15000
        
        task.spawn(function()
            while state.fly and char:Parent() do
                local camera = workspace.CurrentCamera
                local hum = char:FindFirstChildOfClass("Humanoid")
                
                -- Hacer que el personaje flote sin caer
                hum.PlatformStand = true
                bg.CFrame = camera.CFrame
                
                -- Motor de movimiento basado en el Joystick/WASD
                local moveDir = hum.MoveDirection
                if moveDir.Magnitude > 0 then
                    -- Multiplicamos la dirección de la cámara por el movimiento
                    bv.Velocity = camera.CFrame.LookVector * (moveDir.Z < 0 and state.flySpeed or -state.flySpeed) + 
                                  camera.CFrame.RightVector * (moveDir.X > 0 and state.flySpeed or -state.flySpeed)
                    
                    -- Corrección si solo vas de lado
                    if moveDir.Z == 0 then
                        bv.Velocity = camera.CFrame.RightVector * (moveDir.X * state.flySpeed)
                    end
                else
                    bv.Velocity = Vector3.new(0, 0.1, 0) -- Flotar estático
                end
                RunService.RenderStepped:Wait()
            end
            bv:Destroy()
            bg:Destroy()
            if hum then hum.PlatformStand = false end
        end)
    end
end)

fMov:AddSlider("VELOCIDAD VUELO", 10, 500, 50, function(v)
    state.flySpeed = v
end)

fMov:AddButton("NOCLIP (ATRAVESAR)", function()
    state.noclip = not state.noclip
    RunService.Stepped:Connect(function()
        if state.noclip and player.Character then
            for _, p in pairs(player.Character:GetDescendants()) do
                if p:IsA("BasePart") then p.CanCollide = false end
            end
        end
    end)
end)

fMov:AddSlider("WALKSPEED", 16, 300, 16, function(v)
    if player.Character and player.Character:FindFirstChild("Humanoid") then 
        player.Character.Humanoid.WalkSpeed = v 
    end
end)
