local RainbowUI = loadstring(game:HttpGet("https://raw.githubusercontent.com/luis32405516-cmyk/library.lua/refs/heads/main/Prueba2?v=" .. tick()))()
local hud = RainbowUI:CreateWindow(240, 520)

local player = game.Players.LocalPlayer
local RunService = game:GetService("RunService")
local state = { fly = false, flySpeed = 50, noclip = false }

local fMov = hud:AddFolder("AJUSTES PERSONAJE âš™ï¸")

-- FUNCIÃ“N FLY RECONSTRUIDA
fMov:AddButton("VOLAR (FLY V3)", function()
    state.fly = not state.fly
    local char = player.Character
    if not char then return end
    local hum = char:FindFirstChildOfClass("Humanoid")
    local root = char:FindFirstChild("HumanoidRootPart") or char:FindFirstChild("Torso") or char:FindFirstChild("UpperTorso")
    
    if state.fly then
        hud:Notify("Fly: ACTIVADO ðŸš€")
        hum.PlatformStand = true
        char.Animate.Disabled = true
        
        -- Estabilizadores (Como el script original)
        local bg = Instance.new("BodyGyro", root)
        local bv = Instance.new("BodyVelocity", root)
        bg.Name = "FlyGyro"
        bv.Name = "FlyVel"
        
        bg.maxTorque = Vector3.new(9e9, 9e9, 9e9)
        bg.P = 9e4
        bv.maxForce = Vector3.new(9e9, 9e9, 9e9)
        bv.velocity = Vector3.new(0, 0.1, 0)

        task.spawn(function()
            while state.fly and char:Parent() do
                local camera = workspace.CurrentCamera
                local moveDir = hum.MoveDirection
                
                -- LÃ³gica de direcciÃ³n de cÃ¡mara + Joystick
                if moveDir.Magnitude > 0 then
                    bv.velocity = (camera.CFrame.LookVector * (moveDir.Z < 0 and 1 or moveDir.Z > 0 and -1 or 0) + 
                                  camera.CFrame.RightVector * (moveDir.X > 0 and 1 or moveDir.X < 0 and -1 or 0)).Unit * state.flySpeed
                else
                    bv.velocity = Vector3.new(0, 0.1, 0)
                end
                
                bg.cframe = camera.CFrame
                RunService.RenderStepped:Wait()
            end
            -- Limpieza al apagar
            bg:Destroy()
            bv:Destroy()
            hum.PlatformStand = false
            char.Animate.Disabled = false
            hud:Notify("Fly: DESACTIVADO ðŸ›‘")
        end)
    end
end)

-- SLIDER DE VELOCIDAD (Ajustado para BodyVelocity)
fMov:AddSlider("VELOCIDAD VUELO", 10, 500, 50, function(v)
    state.flySpeed = v
end)

fMov:AddButton("NOCLIP (ATRAVESAR)", function()
    state.noclip = not state.noclip
    if state.noclip then
        hud:Notify("Noclip: ACTIVADO ðŸ‘»")
        local noclipLoop
        noclipLoop = RunService.Stepped:Connect(function()
            if not state.noclip then noclipLoop:Disconnect() return end
            if player.Character then
                for _, p in pairs(player.Character:GetDescendants()) do
                    if p:IsA("BasePart") then p.CanCollide = false end
                end
            end
        end)
    else
        hud:Notify("Noclip: DESACTIVADO ðŸ§±")
    end
end)

fMov:AddSlider("VELOCIDAD CAMINAR", 16, 500, 16, function(v)
    if player.Character and player.Character:FindFirstChild("Humanoid") then 
        player.Character.Humanoid.WalkSpeed = v 
    end
end)

fMov:AddSlider("FUERZA SALTO", 50, 600, 50, function(v)
    if player.Character and player.Character:FindFirstChild("Humanoid") then 
        player.Character.Humanoid.JumpPower = v
        player.Character.Humanoid.UseJumpPower = true
    end
end)
