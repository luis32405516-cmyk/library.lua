local RainbowUI = {}

function RainbowUI:CreateWindow(width, height)
    local sg = Instance.new("ScreenGui", game.CoreGui)
    sg.Name = "RainbowUI"

    local main = Instance.new("Frame", sg)
    main.Size = UDim2.new(0, width or 230, 0, height or 220)
    main.Position = UDim2.new(0.5, -width/2, 0.5, -height/2)
    main.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
    main.Active = true
    main.Draggable = true
    Instance.new("UICorner", main).CornerRadius = UDim.new(0, 10)

    local line = Instance.new("Frame", main)
    line.Size = UDim2.new(1, 0, 0, 3)
    line.BorderSizePixel = 0
    Instance.new("UICorner", line).CornerRadius = UDim.new(0, 10)

    local container = Instance.new("ScrollingFrame", main)
    container.Size = UDim2.new(1, -10, 1, -10)
    container.Position = UDim2.new(0, 5, 0, 7)
    container.BackgroundTransparency = 1
    container.CanvasSize = UDim2.new(0, 0, 0, 0)
    container.AutomaticCanvasSize = Enum.AutomaticSize.Y
    container.ScrollBarThickness = 3

    local layout = Instance.new("UIListLayout", container)
    layout.Padding = UDim.new(0, 5)
    layout.HorizontalAlignment = Enum.HorizontalAlignment.Center

    game:GetService("RunService").RenderStepped:Connect(function()
        line.BackgroundColor3 = Color3.fromHSV((tick() * 0.5) % 1, 1, 1)
    end)

    local window = {}

    function window:AddButton(text, callback)
        local btn = Instance.new("TextButton", container)
        btn.Size = UDim2.new(0.9, 0, 0, 30)
        btn.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
        btn.TextColor3 = Color3.new(1, 1, 1)
        btn.Text = text
        btn.Font = Enum.Font.SourceSansBold
        btn.TextSize = 14
        Instance.new("UICorner", btn).CornerRadius = UDim.new(0, 8)
        btn.MouseButton1Click:Connect(callback)
    end

    function window:AddFolder(name)
        local folderFrame = Instance.new("Frame", container)
        folderFrame.Size = UDim2.new(0.9, 0, 0, 30)
        folderFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
        folderFrame.ClipsDescendants = true
        Instance.new("UICorner", folderFrame).CornerRadius = UDim.new(0, 8)

        local fLabel = Instance.new("TextButton", folderFrame)
        fLabel.Size = UDim2.new(1, 0, 0, 30)
        fLabel.BackgroundTransparency = 1
        fLabel.Text = "  ▼ " .. name
        fLabel.TextColor3 = Color3.new(1, 1, 1)
        fLabel.TextXAlignment = Enum.TextXAlignment.Left
        fLabel.Font = Enum.Font.SourceSansBold

        local fContent = Instance.new("Frame", folderFrame)
        fContent.Size = UDim2.new(1, 0, 0, 0)
        fContent.Position = UDim2.new(0, 0, 0, 30)
        fContent.BackgroundTransparency = 1
        local fLayout = Instance.new("UIListLayout", fContent)
        fLayout.Padding = UDim.new(0, 5)
        fLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center

        local open = false
        fLabel.MouseButton1Click:Connect(function()
            open = not open
            folderFrame.Size = open and UDim2.new(0.9, 0, 0, fLayout.AbsoluteContentSize.Y + 35) or UDim2.new(0.9, 0, 0, 30)
            fLabel.Text = open and "  ▲ " .. name or "  ▼ " .. name
        end)

        local folder = {}
        function folder:AddButton(text, callback)
            local b = Instance.new("TextButton", fContent)
            b.Size = UDim2.new(0.95, 0, 0, 25)
            b.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
            b.TextColor3 = Color3.new(1, 1, 1)
            b.Text = text
            Instance.new("UICorner", b).CornerRadius = UDim.new(0, 6)
            b.MouseButton1Click:Connect(callback)
        end
        
        function folder:AddRowButtons(b1, b2)
            local row = Instance.new("Frame", fContent)
            row.Size = UDim2.new(0.95, 0, 0, 25)
            row.BackgroundTransparency = 1
            local rLayout = Instance.new("UIListLayout", row)
            rLayout.FillDirection = Enum.FillDirection.Horizontal
            rLayout.Padding = UDim.new(0, 5)
            rLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center

            local function createRowBtn(data)
                local b = Instance.new("TextButton", row)
                b.Size = UDim2.new(0.5, -3, 1, 0)
                b.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
                b.TextColor3 = Color3.new(1, 1, 1)
                b.Text = data.text
                Instance.new("UICorner", b).CornerRadius = UDim.new(0, 6)
                b.MouseButton1Click:Connect(data.callback)
            end
            createRowBtn(b1)
            createRowBtn(b2)
        end
        return folder
    end

    function window:Notify(msg, dur)
        local n = Instance.new("TextLabel", sg)
        n.Size = UDim2.new(0, 180, 0, 30)
        n.Position = UDim2.new(0.5, -90, 0.1, 0)
        n.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
        n.TextColor3 = Color3.new(1, 1, 1)
        n.Text = msg
        Instance.new("UICorner", n).CornerRadius = UDim.new(0, 8)
        task.delay(dur or 2, function() n:Destroy() end)
    end

    return window
end

return RainbowUI
